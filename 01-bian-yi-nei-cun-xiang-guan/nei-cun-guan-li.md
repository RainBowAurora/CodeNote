---
description: '面试高频指数: ★★★★★'
---

# 内存管理

### 内存分区

C++ 内存分区：栈、堆、全局/静态存储区、常量存储区、代码区： 

* 栈：存放函数的局部变量、函数参数、返回地址等，由编译器自动分配和释放。
* 堆：动态申请的内存空间，就是由 malloc 分配的内存块，由程序员控制它的分配和释放，如果程序执行结束还没有释放，操作系统会自动回收。 
* 全局区/静态存储区（.bss 段和 .data 段）：存放全局变量和静态变量，程序运行结束操作系统自动释放，在 C 语言中，未初始化的放在 .bss 段中，初始化的放在 .data 段中，C++ 中不再区分了。 
* 常量存储区（.data 段）：存放的是常量，不允许修改，程序运行结束自动释放。 
* 代码区（.text 段）：存放代码，不允许修改，但可以执行。编译后的二进制文件存放在这里。

> 从操作系统的本身来讲，以上存储区在内存中的分布是如下形式\(从低地址到高地址\)：.text 段 --&gt; .data 段 --&gt; .bss 段 --&gt; 堆 --&gt; unused --&gt; 栈 --&gt; env

```cpp
#include <iostream>
using namespace std;

/*
说明：C++ 中不再区分初始化和未初始化的全局变量、静态变量的存储区，如果非要区分下述程序标注在了括号中
*/

int g_var = 0; // g_var 在全局区（.data 段）
char *gp_var;  // gp_var 在全局区（.bss 段）

int main()
{
    int var;                    // var 在栈区
    char *p_var;                // p_var 在栈区
    char arr[] = "abc";         // arr 为数组变量，存储在栈区；"abc"为字符串常量，存储在常量区
    char *p_var1 = "123456";    // p_var1 在栈区；"123456"为字符串常量，存储在常量区
    static int s_var = 0;       // s_var 为静态变量，存在静态存储区（.data 段）
    p_var = (char *)malloc(10); // 分配得来的 10 个字节的区域在堆区
    free(p_var);
    return 0;
}
```

